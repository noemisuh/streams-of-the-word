<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>말씀따라 흐르는 샘물</title>
<meta name="color-scheme" content="light dark">
<style>
  :root {
    --fg:#111827; --muted:#6b7280; --line:#d1d5db; --line-strong:#9ca3af;
    --accent:#0ea5e9; --bg:#ffffff; --bgsoft:#f8fafc; --box:#ffffff; --box-line:#d1d5db; --box-tint:#f0f9ff;
  }
  @media (prefers-color-scheme: dark){
    :root {
      --fg:#e5e7eb; --muted:#9ca3af; --line:#2b2f36; --line-strong:#4b5563;
      --bg:#0b0f14; --bgsoft:#0f141a; --box:#0c1218; --box-line:#1f2937; --box-tint:#0c141c;
    }
    body { background: var(--bg); }
  }
  * { box-sizing:border-box; }
  body {
    margin:0;
    font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Noto Sans KR", "Apple SD Gothic Neo", sans-serif;
    color:var(--fg); background:var(--bg);
  }
  .wrap { max-width: 940px; margin: 28px auto; padding: 0 12px; }

  /* Header compact + oval title */
  header { display:flex; justify-content:center; align-items:center; margin:6px 0 4px; }
  .brand {
    display:inline-flex; align-items:center; justify-content:center;
    padding:6px 14px; border:1.5px solid var(--line-strong);
    border-radius:999px; background:var(--bgsoft);
  }
  .brand h1 { font-size:16px; margin:0; letter-spacing:-0.2px; font-weight:700; }

  /* Reserved text (empty) */
  .meta { display:grid; gap:3px; margin:4px 0 4px; }
  .page-title { min-height:12px; font-weight:600; font-size:15px; }
  .page-subtitle { min-height:10px; color:var(--muted); font-size:13px; }
  .page-note { min-height:10px; color:var(--muted); font-size:12px; }

  /* Year + Month bars */
  .yearbar { display:flex; justify-content:center; margin:2px 0 2px; }
  .yearbar .year { font-size:16px; font-weight:700; letter-spacing:-0.3px; }
  .monthbar { display:flex; gap:10px; flex-wrap:wrap; justify-content:center; margin:4px 0 6px; }
  .monthbar a { text-decoration:none; color:var(--muted); padding:2px 0; font-size:14px; }
  .monthbar a.active { color:var(--accent); font-weight:700; }

  /* Calendar grid (strong lines) */
  .cal { width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed; }
  .cal thead th {
    background:var(--bgsoft); position:sticky; top:0; z-index:1;
    font-weight:700; padding:8px; font-size:13px; border-bottom:2px solid var(--line-strong);
    border-top:1.5px solid var(--line-strong);
    border-left:1.5px solid var(--line-strong);
  }
  .cal thead th:last-child { border-right:1.5px solid var(--line-strong); }
  .cal tbody td {
    padding:6px; position:relative; background:var(--bg);
    border-left:1.5px solid var(--line);
    border-bottom:1.5px solid var(--line);
    height:auto; /* auto-height to respect square box */
  }
  .cal tbody tr:last-child td { border-bottom:1.5px solid var(--line-strong); }
  .cal tbody td:last-child { border-right:1.5px solid var(--line-strong); }
  .cal tbody td:first-child { border-left:1.5px solid var(--line-strong); }

  /* Day number at fixed top */
  .daynum { display:inline-block; font-size:11px; color:var(--muted); user-select:none; }

  /* Square content box below the day number */
  .box {
    width:100%; aspect-ratio:1/1; margin-top:4px;
    border:1.5px solid var(--box-line);
    background: linear-gradient(180deg, var(--box-tint) 0%, var(--box) 80%);
    border-radius:12px; position:relative; overflow:hidden;
    box-shadow: 0 1px 0 rgba(0,0,0,.02), 0 6px 12px rgba(0,0,0,.04);
    transition: border-color .15s ease, box-shadow .15s ease, transform .06s ease;
  }
  .box.link { cursor:pointer; }
  .box.link:hover {
    border-color: var(--accent);
    box-shadow: 0 1px 0 rgba(0,0,0,.03), 0 10px 18px rgba(0,0,0,.08);
  }
  .box.link:active { transform: translateY(1px); }

  @media (max-width:640px){
    .wrap { margin: 20px auto; }
    .brand h1 { font-size:15px; }
    .yearbar .year { font-size:15px; }
    .monthbar a { font-size:13px; }
    .cal thead th { padding:8px; font-size:12px; }
  }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand"><h1>말씀따라 흐르는 샘물</h1></div>
  </header>

  <!-- 예약 텍스트(비움) -->
  <div class="meta">
    <div class="page-title" id="page-title"><!-- 큰 제목(선택) --></div>
    <div class="page-subtitle" id="page-subtitle"><!-- 보조 제목(선택) --></div>
    <div class="page-note" id="page-note"><!-- 안내 메모(선택) --></div>
  </div>

  <!-- 연도 -->
  <div class="yearbar" aria-label="연도">
    <div class="year" id="year-label"></div>
  </div>

  <!-- 1~12월 -->
  <div class="monthbar" id="monthbar" aria-label="월 선택"></div>

  <table class="cal" aria-label="월력" id="cal">
    <thead>
      <tr>
        <th scope="col">일</th><th scope="col">월</th><th scope="col">화</th><th scope="col">수</th>
        <th scope="col">목</th><th scope="col">금</th><th scope="col">토</th>
      </tr>
    </thead>
    <tbody id="tbody"></tbody>
  </table>
</div>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  let year = parseInt(qs.get('y')||'2025', 10);
  let month = parseInt(qs.get('m')||'9', 10); // 기본 9월 링크로 진입

  function setYearLabel(y){
    document.getElementById('year-label').textContent = y + "년";
  }

  function buildMonthbar(y, activeM){
    const mb = document.getElementById('monthbar');
    mb.innerHTML = "";
    for(let m=1;m<=12;m++){
      const a = document.createElement('a');
      a.href = `?y=${y}&m=${m}`;
      a.textContent = `${m}월`;
      if(m===activeM) a.className = 'active';
      mb.appendChild(a);
    }
  }

  function weeksOfMonth(y, m){
    const first = new Date(y, m-1, 1);
    const last  = new Date(y, m, 0);
    const firstDow = first.getDay(); // 0=일
    const days = last.getDate();

    const cells = [];
    for(let i=0;i<firstDow;i++) cells.push(null);
    for(let d=1; d<=days; d++) cells.push(d);
    while(cells.length % 7) cells.push(null);

    const weeks = [];
    for(let i=0;i<cells.length;i+=7) weeks.push(cells.slice(i,i+7));
    return weeks;
  }

  function render(y, m){
    setYearLabel(y);
    buildMonthbar(y, m);

    const tb = document.getElementById('tbody');
    tb.innerHTML = "";
    const weeks = weeksOfMonth(y, m);
    for(const w of weeks){
      const tr = document.createElement('tr');
      for(const d of w){
        const td = document.createElement('td');
        if(d!=null){
          // day number at top
          const sn = document.createElement('span');
          sn.className = 'daynum';
          sn.textContent = d;
          td.appendChild(sn);

          // square box below
          const box = document.createElement('div');
          box.className = 'box';
          // 나중 연결: box.dataset.link = 'posts/....html'; box.classList.add('link');
          td.appendChild(box);
        }
        tr.appendChild(td);
      }
      tb.appendChild(tr);
    }
  }

  // Full box click (when link set)
  document.addEventListener('click', (e)=>{
    const box = e.target.closest('.box.link');
    if(!box) return;
    const url = box.dataset.link;
    if(url) location.href = url;
  });

  render(year, month);
})();
</script>
</body>
</html>
